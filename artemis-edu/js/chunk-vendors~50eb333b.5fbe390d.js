(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~50eb333b"],{a184:function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var r=i("7de8"),a=i("ad5a"),n=i("2bf7"),s=function(){function e(e,t){this.maintainTabIndex={},this.maintanMinTabindex={},this.isSignatureField=!1,this.isKeyDownCheck=!1,this.readOnlyCollection=[],this.isSignatureRendered=!1,this.signatureFieldCollection=[],this.selectedIndex=[],this.pdfViewer=e,this.pdfViewerBase=t}return e.prototype.renderFormFields=function(e){if(this.maxTabIndex=0,this.minTabIndex=-1,this.data=this.pdfViewerBase.getItemFromSessionStorage("_formfields"),this.data){this.formFieldsData=JSON.parse(this.data);var t=document.getElementById(this.pdfViewer.element.id+"_textLayer_"+e),i=document.getElementById(this.pdfViewer.element.id+"_pageCanvas_"+e),a=void 0;if(null!==this.formFieldsData&&null!==i&&null!==t){for(var n=!1,s=0;s<this.formFieldsData.length;s++){var o=this.formFieldsData[s];!n&&Object(r["L"])(o.ActualFieldName)&&o.PageIndex===e&&(a=parseInt(o.FieldName.split("_")[1]),n=!0)}for(var d=0;d<this.formFieldsData.length;d++){var l=this.formFieldsData[d];if(""!==l.FieldName){l.IsInitialField&&(l.Name="InitialField");var h=l["Font"];if(this.pdfViewer.formDesigner){if(parseFloat(l["PageIndex"])==e){var u=void 0,f=void 0,g=void 0;null!==h&&h.Height&&(u=h.Name,h.Italic&&(f="Italic"),h.Bold&&(f="Bold"),h.Strikeout&&(f="Strikethrough"),h.Underline&&(f="Underline"),g=this.ConvertPointToPixel(h.Size));var p=2===l.Alignment?"right":1===l.Alignment?"center":"left",c=l["BackColor"],m=l["LineBounds"],F="rgba("+c.R+","+c.G+","+c.B+",1)";!0===l.IsTransparent&&(F="rgba(0,0,0,0)"),F=this.rgbaToHex(F),"#000000ff"===F&&(F="#daeaf7ff");var w=l["FontColor"],y=this.ConvertPointToPixel(m.X),v=this.ConvertPointToPixel(m.Y),S=this.ConvertPointToPixel(m.Width),x=this.ConvertPointToPixel(m.Height),b={left:y,top:v,width:S,height:x},V=!1,I=0;0!==l["Rotation"]?-90!==l["RotationAngle"]&&-270!==l["RotationAngle"]&&-180!==l["RotationAngle"]||(b=this.getBounds(b,e,0,V)):(V=!0,b=this.getBounds(b,e,0,V),I=this.getAngle(e));var B="rgba("+w.R+","+w.G+","+w.B+",1)";B=this.rgbaToHex(B);var T=l["BorderColor"],N="rgba("+T.R+","+T.G+","+T.B+",1)";N=this.rgbaToHex(N);var k=l["BorderWidth"];this.selectedIndex=[];var C={bounds:{X:b.left,Y:b.top,Width:b.width,Height:b.height},pageNumber:parseFloat(l["PageIndex"])+1,name:l["ActualFieldName"],tooltip:l["ToolTip"],value:l["Text"],isChecked:l["Selected"],isSelected:l["Selected"],fontFamily:u,fontStyle:f,backgroundColor:F,color:B,borderColor:N,thickness:k,fontSize:g,isMultiline:l.Multiline,rotateAngle:I,isReadOnly:l["IsReadonly"],isRequired:l["IsRequired"],alignment:p,options:this.getListValues(l),selectedIndex:this.selectedIndex,maxLength:l.MaxLength,visibility:1===l.Visible?"hidden":"visible",font:{isItalic:!Object(r["L"])(h)&&h.Italic,isBold:!Object(r["L"])(h)&&h.Bold,isStrikeout:!Object(r["L"])(h)&&h.Strikeout,isUnderline:!Object(r["L"])(h)&&h.Underline}};l.id||!this.pdfViewer.formFieldCollections[d]||Object(r["L"])(l["ActualFieldName"])||(C.id=this.pdfViewer.formFieldCollections[d].id),"DropDown"!==l.Name&&"ListBox"!==l.Name||(C.value=l["SelectedValue"]);var D=this.getFormFieldType(l);if(("SignatureText"!==l.Name||"SignatureImage"!==l.Name)&&!Object(r["L"])(this.getFormFieldType(l))){if(l.IsRequired){var P=C.thickness;P=P>0?P:1,C.thickness=P}var L=this.pdfViewer.formDesignerModule.addFormField(D,C,!1,C.id);L&&L.parentElement&&(l.id=L.parentElement.id.split("_")[0]),"hidden"===L.style.visibility&&(L.childNodes[0].disabled=!0)}"SignatureField"!==D&&"InitialField"!==D||(this.addSignaturePath(l,a),Object(r["L"])(l.Value)||(this.renderExistingAnnnot(l,parseFloat(l["PageIndex"])+1,null,V),this.isSignatureRendered=!0,a++)),this.pdfViewerBase.isLoadedFormFieldAdded=!0}}else if(parseFloat(l["PageIndex"])==e){var E=this.createFormFields(l,e,d,null,a),_=E.currentField,R=E.count;if(_){var O=this.createParentElement(l,e),M=(m=l["LineBounds"],l["Font"]),A=(V=!1,0);if(0===l["Rotation"]?(V=!0,A=this.getAngle(e),O?O.style.transform="rotate("+A+"deg)":_.style.transform="rotate("+A+"deg)"):O?O.style.transform="rotate("+A+"deg)":_.style.transform="rotate("+A+"deg)",this.applyPosition(_,m,M,e,0,V),_.InsertSpaces=l.InsertSpaces,_.InsertSpaces){var z=this.pdfViewerBase.getZoomFactor(),W=parseInt(_.style.width)/_.maxLength-parseFloat(_.style.fontSize)/2-.6*z;_.style.letterSpacing=W+"px",_.style.fontFamily="monospace",_.style.paddingLeft=W/2+"px"}l["uniqueID"]=this.pdfViewer.element.id+"input_"+e+"_"+d;for(var q=0;q<this.pdfViewer.formFieldCollections.length;q++)"text"!==_.type&&"password"!==_.type&&"textarea"!==_.type||"SignatureField"===l.Name||l["uniqueID"]===this.pdfViewer.formFieldCollections[q].id&&(this.pdfViewer.formFieldCollections[q].value=l["Text"]);Object(r["L"])(l.Value)&&(l.Value=l["Text"]),this.applyCommonProperties(_,e,d,l,V),this.checkIsReadonly(l,_),this.applyTabIndex(l,_,e),this.checkIsRequiredField(l,_),this.applyDefaultColor(_),this.updateFormFieldsCollection(l),O?(O.appendChild(_),t.appendChild(O)):(_.style.position="absolute",t.appendChild(_)),_.addEventListener("focus",this.focusFormFields.bind(this)),_.addEventListener("blur",this.blurFormFields.bind(this)),_.addEventListener("click",this.updateFormFields.bind(this)),_.addEventListener("change",this.changeFormFields.bind(this)),_.addEventListener("keydown",this.updateFormFieldsValue.bind(this)),_.addEventListener("keyup",this.updateSameFieldsValue.bind(this)),a=R}}}}this.pdfViewer.formDesigner||(window.sessionStorage.removeItem(this.pdfViewerBase.documentId+"_formfields"),this.pdfViewerBase.setItemInSessionStorage(this.formFieldsData,"_formfields"))}}if(this.pdfViewerBase.isFocusField&&this.pdfViewerBase.focusField){var H=document.getElementById(this.pdfViewerBase.focusField.id);if(H){if("SignatureField"!==this.pdfViewerBase.focusField.type&&"InitialField"!==this.pdfViewerBase.focusField.type||!this.pdfViewer.formDesignerModule)H.focus();else{var j=this.pdfViewerBase.focusField.bounds.y;x=this.pdfViewerBase.getPageHeight(this.pdfViewerBase.focusField.pageIndex);this.pdfViewer.bookmark.goToBookmark(this.pdfViewerBase.focusField.pageIndex,x-j)}this.pdfViewerBase.isFocusField=!1,this.pdfViewerBase.focusField=[]}}},e.prototype.trim=function(e){return e.replace(/^\s+|\s+$/gm,"")},e.prototype.rgbaToHex=function(e){var t=e.substring(e.indexOf("(")).split(","),i=parseInt(this.trim(t[0].substring(1)),10),r=parseInt(this.trim(t[1]),10),a=parseInt(this.trim(t[2]),10),n=parseFloat(parseFloat(this.trim(t[3].substring(0,t[3].length-1))).toFixed(2)),s=[i.toString(16),r.toString(16),a.toString(16),Math.round(255*n).toString(16).substring(0,2)];return s.forEach((function(e,t){1===e.length&&(s[t]="0"+e)})),"#"+s.join("")},e.prototype.getListValues=function(e){for(var t=e["TextList"],i=[],r=0;r<t.length;r++)t[r]===e["SelectedValue"]&&this.selectedIndex.push(r),i.push({itemName:t[r],itemValue:t[r]});return"ListBox"===this.getFormFieldType(e)&&(this.selectedIndex=e["SelectedList"]),i},e.prototype.createParentElement=function(e,t){var i;if("Textbox"===e["Name"]||"Password"===e["Name"]){i=document.createElement("div"),i.style.background="white",e.InsertSpaces&&(i.style.background="transparent");var r=e["LineBounds"],a=e["Font"];i.style.position="absolute";var n=!1;0===e["Rotation"]&&(n=!0),this.applyPosition(i,r,a,t,0,n)}return i},e.prototype.getAngle=function(e){var t=0,i=this.pdfViewerBase.pageSize[e];if(i&&i.rotation)switch(i.rotation){case 0:t=0;break;case 1:t=90;break;case 2:t=180;break;case 3:t=270;break}return t},e.prototype.nextField=function(){this.signatureFieldNavigate(!0)},e.prototype.previousField=function(){this.signatureFieldNavigate(!1)},e.prototype.signatureFieldNavigate=function(e){var t,i=e,r=this.signatureFieldCollection;if(0===r.length&&(r=this.getSignField()),this.currentTarget){for(var a=0;a<r.length;a++)if(t=this.pdfViewer.formDesignerModule?r[a].FormField:r[a],this.currentTarget.id===t.uniqueID){this.currentTarget=document.getElementById(t.uniqueID),this.getSignatureIndex(a,r.length,i);break}}else e&&(t=this.pdfViewer.formDesignerModule?r[0].FormField:r[0],t.uniqueID&&(this.currentTarget=document.getElementById(t.uniqueID),this.getSignatureIndex(0,r.length,i,!0)))},e.prototype.getSignatureIndex=function(e,t,i,r){var a=e;r||(i?a++:a--),1===t?this.renderSignatureField(0):a<t&&a>=0?this.renderSignatureField(a):i?a>=t&&this.renderSignatureField(0):a<=0&&this.renderSignatureField(t-1)},e.prototype.renderSignatureField=function(e){var t,i=e,r=this.signatureFieldCollection;if(i<r.length){for(var a=0;a<r.length;a++){var n=this.pdfViewer.formDesignerModule?r[i].FormField.uniqueID:r[i].uniqueID,s=this.pdfViewer.formDesignerModule?r[a].FormField:r[a];if(n===s.uniqueID){var o=s.PageIndex>=0?s.PageIndex:s.pageNumber,d=this.pdfViewer.annotationModule.findRenderPageList(o);d||this.pdfViewer.navigation.goToPage(o),this.currentTarget=document.getElementById(s.uniqueID),t=s;break}}if(null===this.currentTarget){o=t.PageIndex>=0?t.PageIndex:t.pageNumber;this.pdfViewer.navigation.goToPage(o),this.currentTarget=document.getElementById(t.uniqueID)}this.currentTarget&&("e-pdfviewer-signatureformfields-signature"===this.currentTarget.className?(document.getElementById(this.currentTarget.id).focus(),this.pdfViewer.select([this.currentTarget.id],null)):"e-pdfviewer-signatureformfields"===this.currentTarget.className&&(this.pdfViewer.formDesignerModule?document.getElementById(this.currentTarget.id).parentElement.focus():document.getElementById(this.currentTarget.id).focus()))}},e.prototype.setFocus=function(e){if(e){this.removeFocus();var t=document.getElementById(e);t.classList.add("e-pv-signature-focus")}else this.currentTarget&&document.getElementById(this.currentTarget.id).focus()},e.prototype.removeFocus=function(){if(this.signatureFieldCollection){var e=this.signatureFieldCollection;0===e.length&&(e=this.getSignField());for(var t=0;t<this.signatureFieldCollection.length;t++){var i=this.pdfViewer.formDesignerModule?this.signatureFieldCollection[t].FormField.uniqueID:this.signatureFieldCollection[t].uniqueID,r=document.getElementById(i);r&&r.classList.remove("e-pv-signature-focus")}this.pdfViewer.formFieldsModule.currentTarget&&this.pdfViewer.formFieldsModule.currentTarget.classList.remove("e-pv-signature-focus")}},e.prototype.getSignField=function(){return this.pdfViewer.formDesignerModule?this.signatureFieldCollection=this.pdfViewer.formDesignerModule.getFormDesignerSignField(this.signatureFieldCollection):this.signatureFieldCollection=this.getFormFieldSignField(),this.signatureFieldCollection},e.prototype.getFormFieldSignField=function(){var e,t=this.pdfViewerBase.getItemFromSessionStorage("_formfields");if(t)for(var i=JSON.parse(t),r=0;r<i.length;r++)e=i[r],"SignatureField"===e.Name&&(e["uniqueID"]=this.pdfViewer.element.id+"input_"+e.PageIndex+"_"+r,this.signatureFieldCollection.push(i[r]));return this.signatureFieldCollection},e.prototype.formFieldCollections=function(){var e=this.pdfViewerBase.getItemFromSessionStorage("_formfields");if(e)for(var t=JSON.parse(e),i=0;i<t.length;i++){var r=t[i],a=r["Name"];if(this.pdfViewer.formDesignerModule)"ink"!==r.Name&&"SignatureImage"!==r.Name&&"SignatureText"!==r.Name&&this.retreiveFormFieldsData(r,!0);else if("ink"!==r.Name){var n={name:this.retriveFieldName(r),id:this.pdfViewer.element.id+"input_"+parseFloat(r["PageIndex"])+"_"+i,isReadOnly:!1,type:r.IsInitialField?"InitialField":a,value:this.retriveCurrentValue(r),fontName:"",isRequired:r.IsRequired};this.pdfViewer.formFieldCollections.push(n)}}},e.prototype.retreiveFormFieldsData=function(e,t){var i,a,n;if(""!==e.FieldName){e.IsInitialField&&(e.Name="InitialField");var s=e["Font"];null!==s&&s.Height&&(i=s.Name,s.Italic&&(a="Italic"),s.Bold&&(a="Bold"),s.Strikeout&&(a="Strikethrough"),s.Underline&&(a="Underline"),n=this.ConvertPointToPixel(s.Size));var o=2===e.Alignment?"right":1===e.Alignment?"center":"left",d=e["BackColor"],l=e["LineBounds"],h="rgba("+d.R+","+d.G+","+d.B+",1)";h=this.rgbaToHex(h),"#000000ff"===h&&(h="#daeaf7ff");var u=e["FontColor"],f=this.ConvertPointToPixel(l.X),g=this.ConvertPointToPixel(l.Y),p=this.ConvertPointToPixel(l.Width),c=this.ConvertPointToPixel(l.Height),m={left:f,top:g,width:p,height:c},F="rgba("+u.R+","+u.G+","+u.B+",1)";F=this.rgbaToHex(F);var w=e["BorderColor"],y="rgba("+w.R+","+w.G+","+w.B+",1)";y=this.rgbaToHex(y);var v=e["BorderWidth"];this.selectedIndex=[];var S={bounds:{X:m.left,Y:m.top,Width:m.width,Height:m.height},pageNumber:parseFloat(e["PageIndex"])+1,name:e["ActualFieldName"],tooltip:e["ToolTip"],value:e["Text"],isChecked:e["Selected"],isSelected:e["Selected"],fontFamily:i,fontStyle:a,backgroundColor:h,color:F,borderColor:y,thickness:v,fontSize:n,isMultiline:e.Multiline,isReadOnly:e["IsReadonly"],isRequired:e["IsRequired"],alignment:o,options:this.getListValues(e),selectedIndex:this.selectedIndex,maxLength:e.MaxLength,visibility:1===e.Visible?"hidden":"visible",font:{isItalic:!Object(r["L"])(s)&&s.Italic,isBold:!Object(r["L"])(s)&&s.Bold,isStrikeout:!Object(r["L"])(s)&&s.Strikeout,isUnderline:!Object(r["L"])(s)&&s.Underline}};"DropDown"!==e.Name&&"ListBox"!==e.Name||(S.value=e["SelectedValue"]);var x=this.getFormFieldType(e);"SignatureField"!==x&&"InitialField"!==x||(this.addSignaturePath(e),this.isSignatureField&&(S.value=e.Value));var b=this.pdfViewer.formDesignerModule.addFormField(x,S,t);return b}return null},e.prototype.updateFormFieldsCollection=function(e){var t=e["Name"],i={name:this.retriveFieldName(e),id:e.uniqueID,isReadOnly:e.IsReadonly,isRequired:e.IsRequired,isSelected:"CheckBox"!==t&&e.Selected,isChecked:"RadioButton"!==t&&e.Selected,type:t,value:"ListBox"===t||"DropDown"===t?e.SelectedValue:e.Value,fontName:e.FontFamily?e.FontFamily:""};this.pdfViewer.formFieldCollections[this.pdfViewer.formFieldCollections.findIndex((function(e){return e.id===i.id}))]=i},e.prototype.updateFormFieldValues=function(e){if(this.readOnlyCollection.push(e.id),e){var t=document.getElementById(e.id);t&&(e.isReadOnly?(t.disabled=!0,t.style.backgroundColor="",t.style.cursor="default"):(""===t.style.backgroundColor&&(t.style.backgroundColor="rgba(0, 20, 200, 0.2)"),t.disabled=!1,t.style.cursor="")),this.updateDataInSession(t)}},e.prototype.retriveFieldName=function(e){var t;switch(e["Name"]){case"Textbox":case"Password":case"SignatureField":case"InitialField":t=e.FieldName;break;case"RadioButton":case"CheckBox":t=e.GroupName;break;case"DropDown":case"ListBox":t=e.Text;break}return t},e.prototype.retriveCurrentValue=function(e){var t;switch(e["Name"]){case"Textbox":case"Password":t=e.Text;break;case"SignatureField":t=e.Value;break;case"RadioButton":case"CheckBox":t=e.Selected;break;case"DropDown":t=e.SelectedValue;break;case"ListBox":t=e.SelectedList;break}return t},e.prototype.getSignatureBounds=function(e,t,i){var r=this.pdfViewerBase.pageSize[i],a=0;switch(r.rotation){case 0:a=t;break;case 1:a={x:t.x+e.Width+t.width/3.5,y:r.width-e.X+t.height/4};break;case 2:a={x:r.width-t.x-t.width,y:r.height-t.y-t.height};break;case 3:a={x:t.y-t.width/2+t.height,y:t.x+t.width/3};break}return a},e.prototype.downloadFormFieldsData=function(){var e=this.pdfViewerBase.getItemFromSessionStorage("_formfields");if(e){for(var t=JSON.parse(e),i={},r=[],n=0;n<t.length;n++){var s=t[n],o=s.IsRequired;if("Textbox"===s.Name||"Password"===s.Name||s.Multiline)!o||""!==s.Text&&null!==s.Text?delete this.pdfViewerBase.nonFillableFields[s.FieldName]:(this.pdfViewerBase.validateForm=!0,this.pdfViewerBase.nonFillableFields[s.FieldName]=s.Text),r={fieldValue:s.Text,isReadOnly:s.IsReadonly},i[s.FieldName]=r;else if("RadioButton"===s.Name&&s.Selected)o&&!1===s.Selected?(this.pdfViewerBase.validateForm=!0,this.pdfViewerBase.nonFillableFields[s.GroupName]=s.Value):delete this.pdfViewerBase.nonFillableFields[s.GroupName],r={fieldValue:s.Value,isReadOnly:s.IsReadonly},i[s.GroupName]=r;else if("CheckBox"===s.Name)o&&!1===s.Selected?(this.pdfViewerBase.validateForm=!0,this.pdfViewerBase.nonFillableFields[s.GroupName]=s.Selected):delete this.pdfViewerBase.nonFillableFields[s.GroupName],s.CheckboxIndex&&s.Selected?(r={fieldValue:s.CheckboxIndex,isReadOnly:s.IsReadonly},i[s.GroupName]=r):void 0!==i[s.GroupName]&&null!==i[s.GroupName]||(r={fieldValue:s.Selected,isReadOnly:s.IsReadonly},i[s.GroupName]=r);else if("DropDown"===s.Name)o&&""===s.SelectedValue?(this.pdfViewerBase.validateForm=!0,this.pdfViewerBase.nonFillableFields[s.Text]=s.SelectedValue):delete this.pdfViewerBase.nonFillableFields[s.Text],r={fieldValue:s.SelectedValue,isReadOnly:s.IsReadonly},i[s.Text]=r;else if("ListBox"===s.Name){for(var d=s["TextList"],l=[],h=0;h<s.SelectedList.length;h++){var u=s.SelectedList[h];l.push(d[u])}r={fieldValue:JSON.stringify(l),isReadOnly:s.IsReadonly},i[s.Text]=r}else if("SignatureField"===s.Name||"InitialField"===s.Name){var f=void 0;if(null!==s.Value&&""!==s.Value||this.addSignaturePath(s),s.Value&&""!==s.Value){f=s.Value;var g=s.fontFamily?s.fontFamily:s.FontFamily;if(g)i[s.FieldName+"fontName"]=g,i[s.FieldName+"fontSize"]=s.fontSize?s.fontSize:s.FontSize;else if(s.Value.split("base64,")[1])i[s.FieldName+"ImageData"]=!0;else{var p=Object(a["d"])(s.Value);f=Object(a["e"])(p)}}if(o&&null===s.Value||""===s.Value?(this.pdfViewerBase.validateForm=!0,this.pdfViewerBase.nonFillableFields[s.FieldName]=JSON.stringify(f)):delete this.pdfViewerBase.nonFillableFields[s.FieldName],i[s.FieldName]=JSON.stringify(f),s.Bounds){var c=this.getSignatureBounds(s.LineBounds,s.Bounds,s.PageIndex);s.Bounds.x=c.x,s.Bounds.y=c.y,i[s.FieldName+"bounds"]=JSON.stringify(s.Bounds)}else{var m=s.LineBounds;c={x:this.ConvertPointToPixel(m.X),y:this.ConvertPointToPixel(m.Y),width:this.ConvertPointToPixel(m.Width),height:this.ConvertPointToPixel(m.Height)};i[s.FieldName+"bounds"]=JSON.stringify(c)}i[s.FieldName+"isReadOnly"]=s.IsReadonly}}return JSON.stringify(i)}},e.prototype.focusFormFields=function(e){var t=e.target;if(t&&"e-pdfviewer-signatureformfields"!==t.className&&"e-pdfviewer-signatureformfields e-pv-signature-focus"!==t.className){var i=t.style.backgroundColor,r=i.lastIndexOf(","),a=i.slice(0,r+1)+0+")";t.style.backgroundColor=a}else t&&("e-pdfviewer-signatureformfields"!==t.className&&"e-pdfviewer-signatureformfields-signature"!==t.className&&"e-pdfviewer-signatureformfields e-pv-signature-focus"!==t.className&&"e-pdfviewer-signatureformfields-signature  e-pv-signature-focus"!==t.className||this.setFocus(t.id))},e.prototype.blurFormFields=function(e){var t=e.target;if(t.InsertSpaces&&this.isKeyDownCheck){var i=parseInt(t.style.width)-parseInt(t.style.height)/2;t.style.width=i+"px",this.isKeyDownCheck=!1}"checkbox"===t.type?this.pdfViewer.fireFocusOutFormField(t.name,t.checked):this.pdfViewer.fireFocusOutFormField(t.name,t.value);var r=t.style.backgroundColor,a=r.lastIndexOf(","),n=r.slice(0,a+1)+.2+")";t.style.backgroundColor=n},e.prototype.updateFormFields=function(e){var t=e.target;"e-pdfviewer-ListBox"===t.className?(t=t.parentElement,this.updateDataInSession(t)):"e-pdfviewer-signatureformfields"===t.className||"e-pdfviewer-signatureformfields e-pv-signature-focus"===t.className?this.currentTarget=t:"e-pv-buttonItem"!==t.className&&"button"!==t.type||this.pdfViewer.fireButtonFieldClickEvent(t.value,t.name,t.id);for(var i=0;i<this.pdfViewer.formFieldCollections.length;i++)t.id===this.pdfViewer.formFieldCollections[i].id&&((this.pdfViewer.formDesignerModule||this.pdfViewer.annotationModule)&&this.pdfViewer.fireFormFieldClickEvent("formFieldClicked",this.pdfViewer.formFieldCollections[i]),"e-pdfviewer-signatureformfields"!==t.className&&"e-pdfviewer-signatureformfields-signature"!==t.className&&"e-pdfviewer-signatureformfields e-pv-signature-focus"!==t.className&&"e-pdfviewer-signatureformfields-signature  e-pv-signature-focus"!==t.className||this.setFocus(t.id))},e.prototype.drawSignature=function(e,t,i,r){var a,n,s,o,d;d=this.pdfViewer.formDesigner?this.pdfViewerBase.getItemFromSessionStorage("_formDesigner"):this.pdfViewerBase.getItemFromSessionStorage("_formfields");for(var l=JSON.parse(d),h=i?i.name?i.name:i.offsetParent.name:this.currentTarget.name,u=0;u<l.length;u++){var f=this.pdfViewer.formDesigner?l[u].FormField.name:l[u].ActualFieldName;if(f===h){i=this.pdfViewer.formDesigner?document.getElementById(l[u].Key.split("_")[0]):document.getElementById(l[u].uniqueID);var g=i,p=g.offsetParent.offsetParent.id.split("_")[0],c=this.pdfViewer.nameTable[p];i&&i.offsetParent&&c&&(s=i.getBoundingClientRect(),o=i.offsetParent.offsetParent.offsetParent.getBoundingClientRect(),this.pdfViewerBase.drawSignatureWithTool=!0,i.nextSibling&&-1!==i.nextSibling.id.indexOf("initial")&&(this.pdfViewer.isInitialFieldToolbarSelection=!0));var m=t||this.pdfViewerBase.signatureModule.outputString,F=r||this.pdfViewerBase.signatureModule.fontName,w=this.pdfViewerBase.getZoomFactor(),y=this.pdfViewerBase.drawSignatureWithTool?s.width/w:parseFloat(g.style.width)/w,v=this.pdfViewerBase.drawSignatureWithTool?s.height/w:parseFloat(g.style.height)/w,S=this.pdfViewerBase.drawSignatureWithTool?(s.left-o.left)/w:parseFloat(g.style.left)/w,x=this.pdfViewerBase.drawSignatureWithTool?(s.top-o.top)/w:parseFloat(g.style.top)/w,b=this.pdfViewerBase.drawSignatureWithTool&&i.nextElementSibling?parseFloat(i.nextElementSibling.id.split("_")[0].charAt(i.nextElementSibling.id.split("_")[0].length-1)):parseFloat(g.id.split("_")[1]),V=this.pdfViewerBase.drawSignatureWithTool&&i.nextElementSibling?parseFloat(i.nextElementSibling.id.split("_")[1]):parseFloat(g.id.split("_")[2]),I=this.pdfViewerBase.signatureModule.saveImageString,B=void 0,T=void 0,N=g.offsetParent.offsetParent.style.transform?g.offsetParent.offsetParent.style.transform:g.style.transform;N=N.substring(N.indexOf("(")+1,N.indexOf("d"));var k=N?parseInt(N):0;if("Type"===e){if(F||(F="Helvetica"),n=this.getSignBounds(V,k,b,w,S,x,y,v),"Default"===this.pdfViewer.signatureFitMode&&(n=this.getDefaultBoundsforSign(n)),a={id:g.id,bounds:{x:n.x,y:n.y,width:n.width,height:n.height},pageIndex:b,data:m,modifiedDate:"",shapeAnnotationType:"SignatureText",opacity:1,rotateAngle:k,annotName:"SignatureText",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""},fontFamily:F,fontSize:90===k||270===k?n.width/2:n.height/2},"SignatureText"===a.shapeAnnotationType){var C=this.getTextWidth(a.data,a.fontSize,a.fontFamily),D=1;C>n.width&&(D=n.width/C),a.fontSize=this.getFontSize(Math.floor(a.fontSize*D))}I=a.data,B=a.fontFamily,T=a.fontSize}else if("Image"===e){n=this.getSignBounds(V,k,b,w,S,x,y,v);var P=new Image;if(P.src=m,"Default"===this.pdfViewer.signatureFitMode){var L=20,E=4,_=2;if(Math.abs(P.height-P.width)<L)n.width>n.height?(n.x=n.x+n.width/_-n.height/_,n.width=n.height):(n.y=n.y+n.height/_-n.width/_,n.height=n.width);else if(n.width>n.height){n.y=n.y+n.height/E,n.x=n.x+n.height/E;var R=n.height/_;n={x:n.x,y:n.y,width:n.width-R,height:n.height-R}}else n.y=n.y+n.height/E,n.height=n.height/_}a={id:g.id,bounds:{x:n.x,y:n.y,width:n.width,height:n.height},pageIndex:b,data:m,modifiedDate:"",shapeAnnotationType:"SignatureImage",opacity:1,rotateAngle:k,annotName:"SignatureField",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""}},I=a.data}else if(-1!==m.indexOf("base64"))n=this.getSignBounds(V,k,b,w,S,x,y,v),"Default"===this.pdfViewer.signatureFitMode&&(n=this.getDefaultBoundsforSign(n)),a={id:g.id,bounds:{x:n.x,y:n.y,width:n.width,height:n.height},pageIndex:b,data:m,modifiedDate:"",shapeAnnotationType:"SignatureImage",opacity:1,rotateAngle:k,annotName:"SignatureField",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""}},I=a.data;else{if("Default"===this.pdfViewer.signatureFitMode){var O=this.updateSignatureAspectRatio(m,!1,g);n=this.getSignBounds(V,k,b,w,S,x,O.width,O.height,!0),n.x=n.x+O.left,n.y=n.y+O.top}else n=this.getSignBounds(V,k,b,w,S,x,y,v);a={id:g.id,bounds:{x:n.x,y:n.y,width:n.width,height:n.height},pageIndex:b,data:m,modifiedDate:"",shapeAnnotationType:"Path",opacity:1,rotateAngle:k,annotName:"SignatureField",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""}}}if(this.pdfViewerBase.drawSignatureWithTool&&c){a.id=c.id+"_content";var M=this.pdfViewer.add(a);c.wrapper.children.push(M.wrapper)}else this.pdfViewer.add(a);if(a&&"Path"===a.shapeAnnotationType&&""!==m){this.pdfViewerBase.currentSignatureAnnot=a;var A={currentHeight:v,currentWidth:y,currentLeft:S,currentTop:x};this.pdfViewerBase.signatureModule.addSignatureCollection(n,A),I=this.pdfViewerBase.signatureModule.saveImageString,this.pdfViewerBase.currentSignatureAnnot=null}var z=document.getElementById(this.pdfViewer.element.id+"_annotationCanvas_"+b);if(this.pdfViewer.renderDrawing(z,b),this.pdfViewerBase.signatureModule.showSignatureDialog(!1),"e-pdfviewer-signatureformfields e-pv-signature-focus"===g.className?g.className="e-pdfviewer-signatureformfields-signature e-pv-signature-focus":g.className="e-pdfviewer-signatureformfields-signature",this.pdfViewerBase.drawSignatureWithTool&&c){var W=i.offsetParent.offsetParent.id.split("_")[0]+"_content";this.updateSignatureDataInSession(a,W)}else this.updateDataInSession(g,a.data,a.bounds,B,T);g.style.pointerEvents="none",this.pdfViewer.annotation&&this.pdfViewer.annotation.addAction(a.pageIndex,null,a,"FormField Value Change","",a,a),this.pdfViewer.fireSignatureAdd(a.pageIndex,a.id,"HandWrittenSignature",a.bounds,a.opacity,null,null,I),this.pdfViewer.fireFocusOutFormField(g.name,m)}}this.pdfViewerBase.signatureModule.hideSignaturePanel(),this.pdfViewerBase.drawSignatureWithTool=!1,this.pdfViewer.isInitialFieldToolbarSelection=!1},e.prototype.updateSignatureDataInSession=function(e,t){for(var i=this.pdfViewerBase.getItemFromSessionStorage("_formDesigner"),r=JSON.parse(i),n=function(i){if(r[i].Key===t){var n=s.pdfViewer.formFieldCollections.findIndex((function(e){return e.id===r[i].FormField.id.split("_")[0]}));if("SignatureText"===e.shapeAnnotationType?(r[i].FormField.signatureType="Text",s.pdfViewerBase.formFieldCollection[i].FormField.signatureType="Text",s.pdfViewer.nameTable[t].signatureType="Text",r[i].FormField.fontFamily=e.fontFamily,s.pdfViewerBase.formFieldCollection[i].FormField.fontFamily=e.fontFamily,s.pdfViewer.nameTable[t].fontFamily=e.fontFamily,r[i].FormField.fontSize=e.fontSize,s.pdfViewerBase.formFieldCollection[i].FormField.fontSize=e.fontSize,s.pdfViewer.nameTable[t].fontSize=e.fontSize,n>-1&&(s.pdfViewer.formFieldCollection[n].signatureType="Text")):"SignatureImage"===e.shapeAnnotationType?(r[i].FormField.signatureType="Image",s.pdfViewerBase.formFieldCollection[i].FormField.signatureType="Image",s.pdfViewer.nameTable[t].signatureType="Image",n>-1&&(s.pdfViewer.formFieldCollection[n].signatureType="Image")):(r[i].FormField.signatureType="Path",s.pdfViewerBase.formFieldCollection[i].FormField.signatureType="Path",s.pdfViewer.nameTable[t].signatureType="Path",n>-1&&(s.pdfViewer.formFieldCollection[n].signatureType="Path")),r[i].FormField.signatureBound=e.bounds,s.pdfViewerBase.formFieldCollection[i].FormField.signatureBound=e.bounds,s.pdfViewer.nameTable[t].signatureBound=e.bounds,n>-1&&(s.pdfViewer.formFieldCollection[n].signatureBound=e.bounds),"Path"===e.shapeAnnotationType){var o=Object(a["d"])(e.data),d=Object(a["e"])(o);r[i].FormField.value=JSON.stringify(d),s.pdfViewer.nameTable[t].value=e.data,s.pdfViewer.nameTable[t.split("_")[0]].value=e.data,s.pdfViewerBase.formFieldCollection[i].FormField.value=JSON.stringify(d),n>-1&&(s.pdfViewer.formFieldCollection[n].value=JSON.stringify(d))}else r[i].FormField.value=e.data,s.pdfViewerBase.formFieldCollection[i].FormField.value=e.data,s.pdfViewer.nameTable[t.split("_")[0]].value=e.data,s.pdfViewer.nameTable[t].value=e.data,n>-1&&(s.pdfViewer.formFieldCollection[n].value=e.data);s.pdfViewer.formDesigner.updateFormFieldCollections(r[i].FormField),s.pdfViewer.formDesigner.updateFormFieldPropertiesChanges("formFieldPropertiesChange",r[i].FormField,!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,"",r[i].FormField.value)}},s=this,o=0;o<r.length;o++)n(o);this.pdfViewerBase.setItemInSessionStorage(r,"_formDesigner")},e.prototype.getDefaultBoundsforSign=function(e){return{x:e.x+10,y:e.y+10,width:e.width-23,height:e.height-23}},e.prototype.getSignBounds=function(e,t,i,r,a,n,s,o,d){var l=this.pdfViewer.isInitialFieldToolbarSelection?"initialIcon":"signIcon",h=document.getElementById(l+i+"_"+e),u=h?parseFloat(h.style.left)*r:0,f=a*r-u/r;return 90===t||270===t?(this.rotateAngle=0,""!==h.style.left?d?{x:a-f/r-r,y:n+f/r+r,width:s,height:o}:{x:a-f/r-r,y:n+f/r+r,width:o,height:s}:(f=10,d?{x:a-s,y:n+s,width:o,height:s}:{x:a-s-f/2,y:n+s+f,width:o,height:s})):(this.rotateAngle=0,{x:a,y:n,width:s,height:o})},e.prototype.updateSameFieldsValue=function(e){if(this.formFieldsData)for(var t=0;t<this.formFieldsData.length;t++){var i=this.formFieldsData[t];if(e.target.name===i.FieldName&&e.target.id!==i.uniqueID){var r=document.getElementById(this.formFieldsData[t].uniqueID);r?r.value=e.target.value:(i.Text=e.target.value,this.pdfViewerBase.setItemInSessionStorage(this.formFieldsData,"_formfields"))}}},e.prototype.updateFormFieldsValue=function(e){var t=e.target;if(t.InsertSpaces&&!this.isKeyDownCheck){var i=parseInt(t.style.width)+parseInt(t.style.height)/2;t.style.width=i+"px",this.isKeyDownCheck=!0}if(9===e.which&&t&&"e-pdfviewer-formFields"===t.className){var r=t.id.split("input_")[1].split("_")[0];if(this.maintainTabIndex[r]===t.tabIndex){var a=document.getElementById(this.pdfViewer.element.id+"_textLayer_"+(parseInt(r)+1));if(a){var n=a.getElementsByClassName("e-pdfviewer-formFields");n&&n.length>0&&(n[0].focus(),e.preventDefault())}else for(var s=document.getElementById(this.pdfViewer.element.id+"_textLayer_0"),o=(n=s.getElementsByClassName("e-pdfviewer-formFields"),0);o<n.length;o++)if(n[o].tabIndex===this.maintanMinTabindex["0"]){n[o].focus(),e.preventDefault();break}}else{a=document.getElementById(this.pdfViewer.element.id+"_textLayer_"+parseInt(r)),n=a.getElementsByClassName("e-pdfviewer-formFields");var d=!0;for(o=0;o<n.length;o++)if(d=!1,n[o].tabIndex===t.tabIndex+1){n[o].focus(),d=!0,e.preventDefault();break}var l=t.tabIndex+1;while(!d){for(var h=0;h<n.length;h++)if(d=!1,n[h].tabIndex===l){n[h].focus(),d=!0,e.preventDefault();break}this.maintainTabIndex[r]===l&&(d=!0),l+=1}}}if(e.currentTarget.classList.contains("e-pdfviewer-signatureformfields")||e.currentTarget.classList.contains("e-pdfviewer-signatureformfields-signature"))if("Enter"===e.key){var u=e.target;for(o=0;o<this.pdfViewer.formFieldCollections.length;o++)u.id===this.pdfViewer.formFieldCollections[o].id&&(this.setFocus(u.id),this.pdfViewer.fireFormFieldClickEvent("formFieldClicked",this.pdfViewer.formFieldCollections[o]))}else e.preventDefault()},e.prototype.changeFormFields=function(e){var t=e.target;this.updateDataInSession(t)},e.prototype.calculateSignatureBounds=function(e,t,i,r,a,n,s){var o=i/e,d=r/t,l=this.pdfViewerBase.getZoomFactor(),h=0,u=0,f=!1,g=!1,p=0,c=0;if(a)h=this.pdfViewer.handWrittenSignatureSettings.width?this.pdfViewer.handWrittenSignatureSettings.width:150,u=this.pdfViewer.handWrittenSignatureSettings.height?this.pdfViewer.handWrittenSignatureSettings.height:100;else{var m=n?"100%"===n.style.width?n.clientWidth:parseFloat(n.style.width):this.ConvertPointToPixel(s.LineBounds.Width),F=n?"100%"===n.style.height?n.clientHeight:parseFloat(n.style.height):this.ConvertPointToPixel(s.LineBounds.Height),w=m/F,y=F/m,v=e/t,S=t/e,x=n?n.offsetParent.offsetParent.style.transform?n.offsetParent.offsetParent.style.transform:n.style.transform:s.RotationAngle;if(w>v||y>v||Math.abs(w-y)<=1){var b=0;y>v||Math.abs(w-y)<=1?(g=!0,b=y/S):(f=!0,b=w/v),"rotate(90deg)"===x||"rotate(270deg)"===x?(h=F/l,u=m/l):(f&&(p=m/l,h=m/b/l,u=F/l),g&&(c=F/l,h=m/l,u=F/b/l))}else"rotate(90deg)"===x||"rotate(270deg)"===x?(h=F/l,u=m/l):(h=m/l,u=F/l)}var V=(e-i)/2,I=(t-r)/2;if(f){V=V/e*p;var B=(p*o-h*o)/2;V+=B,I=I/t*u}else if(g){V=V/e*h,I=I/t*c;var T=(c*d-u*d)/2;I+=T}else V=V/e*h,I=I/t*u;return h*=o,u*=d,{currentLeftDiff:V,currentTopDiff:I,currentWidth:h,currentHeight:u}},e.prototype.updateSignatureAspectRatio=function(e,t,i,r){for(var n=Object(a["d"])(e),s=Object(a["e"])(n),o=-1,d=-1,l=-1,h=-1,u=document.getElementById(this.pdfViewer.element.id+"_signatureCanvas_"),f=0,g=0,p=0;p<s.length;p++){var c=s[p];if(-1===o)o=parseFloat(c["x"].toString()),l=parseFloat(c["x"].toString()),d=parseFloat(c["y"].toString()),h=parseFloat(c["y"].toString());else{var m=parseFloat(c["x"].toString()),F=parseFloat(c["y"].toString());o>=m&&(o=m),d>=F&&(d=F),l<=m&&(l=m),h<=F&&(h=F)}}f=u?u.clientWidth:650,g=u?u.clientHeight:300;var w=l-o,y=h-d,v=this.calculateSignatureBounds(f,g,w,y,t,i,r);if(t){var S=this.pdfViewerBase.getZoomFactor(),x=this.pdfViewerBase.currentPageNumber-1,b=document.getElementById(this.pdfViewer.element.id+"_pageDiv_"+x),V=(parseFloat(b.style.width)/2-v.currentWidth/2)/S,I=(parseFloat(b.style.height)/2-v.currentHeight/2)/S;return{x:V,y:I,width:v.currentWidth,height:v.currentHeight}}return{left:v.currentLeftDiff,top:v.currentTopDiff,width:v.currentWidth,height:v.currentHeight}},e.prototype.updateDataInSession=function(e,t,i,r,a){this.pdfViewerBase.updateDocumentEditedProperty(!0);var s=this.pdfViewerBase.getItemFromSessionStorage("_formfields");if(s){for(var o=JSON.parse(s),d=0;d<o.length;d++){var l=o[d];if(l.uniqueID===e.id){if(e&&"text"===e.type||"password"===e.type||"textarea"===e.type){var h=e;h.classList.contains("e-pdfviewer-signatureformfields")||h.classList.contains("e-pdfviewer-signatureformfields-signature")?(t&&(l.Value=t),i&&(l.Bounds=i),r&&(l.FontFamily=r,l.FontSize=a)):(l.Text=e.value,l.Value=e.value)}else if("radio"===e.type){for(var u=0;u<o.length;u++){o[u];o[u].GroupName===e.name&&(o[u].Selected=!1)}l.Selected=!0}else if("checkbox"===e.type){for(u=0;u<o.length;u++){o[u];if(o[u].GroupName===e.name){o[u].Selected=!1;var f=document.getElementById(o[u].uniqueID);f&&l.GroupName===e.name&&l.uniqueID!==f.id&&(l.Selected=!1,f.checked=!1)}}e.checked?l.Selected=!0:l.Selected=!1}else if("select-one"===e.type&&0===e.size)for(var g=e.options[e.selectedIndex].text,p=e.children,c=0;c<p.length;c++)p[c].text===g&&(l.SelectedValue=g);else if("select-multiple"===e.type||e.size>0){g=e.selectedOptions;l.SelectedList=[];for(var m=0;m<g.length;m++)for(p=e.children,c=0;c<p.length;c++)p[c]===g[m]&&l.SelectedList.push(c);l.SelectedValue=e.value;var F=l.TextList?l.TextList.indexOf(e.value):0;l.selectedIndex=F>-1?F:0,l.SelectedList=[l.selectedIndex]}e.disabled&&(l.IsReadonly=!0),this.updateFormFieldsCollection(l);break}e&&null!=e.getAttribute("list")&&"text"===e.type&&l.uniqueID===e.list.id&&(l.SelectedValue=e.value),this.updateFormFieldsCollection(l)}window.sessionStorage.removeItem(this.pdfViewerBase.documentId+"_formfields"),this.pdfViewerBase.setItemInSessionStorage(o,"_formfields")}if(this.pdfViewer.formDesignerModule&&e&&e.id){var w=this.pdfViewer.nameTable[e.id.split("_")[0]];if(w&&w.wrapper&&w.wrapper.children[0]){w.value=e.value;var y=Object(n["b"])(w.wrapper.children[0]).topLeft;this.pdfViewer.formDesignerModule.updateFormDesignerFieldInSessionStorage(y,w.wrapper.children[0],w.formFieldAnnotationType,w)}}},e.prototype.removeExistingFormFields=function(){var e=this.pdfViewerBase.getItemFromSessionStorage("_formDesigner"),t=JSON.parse(e);if(t)for(var i=0;i<t.length;i++)this.pdfViewer.formDesignerModule.deleteFormField(t[i].Key.split("_")[0])},e.prototype.applyCommonProperties=function(e,t,i,r,a){var n=document.getElementById(this.pdfViewer.element.id+"input_"+t+"_"+i);if(n){var s=document.getElementById(this.pdfViewer.element.id+"_textLayer_"+t);"text"===e.type&&n.parentElement!==s&&n.parentElement.remove(),n.remove()}var o,d,l,h,u=document.getElementById("signIcon"+t+"_"+t),f=parseFloat(e.style.left),g=parseInt(e.style.top),p=parseFloat(e.style.width),c=parseFloat(e.style.height),m=this.pdfViewerBase.getZoomFactor();u&&!a&&(o=parseFloat(u.style.width),d=parseFloat(u.style.height),"rotate(90deg)"==u.style.transform&&(u.style.transform="rotate(0deg)",l=c/2,h=o*m,u.style.left=f-(l-o*m)+h/2+"px"),"rotate(180deg)"==u.style.transform&&(u.style.transform="rotate(0deg)",u.style.left=f+"px",u.style.top=g+"px"),"rotate(270deg)"==u.style.transform&&(u.style.transform="rotate(0deg)",l=c/2,h=o*m,u.style.left=f-(l-h)+h/2+"px",u.style.top=g+(p+d*m)+d*m/2+"px")),r.IsSignatureField&&this.isSignatureField?(e.className="e-pdfviewer-signatureformfields-signature",e.style.pointerEvents="none"):r.IsSignatureField?r.Value?(e.className="e-pdfviewer-signatureformfields-signature",e.style.pointerEvents="none"):e.className="e-pdfviewer-signatureformfields":"Button"!==r.Name&&(e.className="e-pdfviewer-formFields"),e.id=this.pdfViewer.element.id+"input_"+t+"_"+i,e.style.zIndex=1e3},e.prototype.createFormFields=function(e,t,i,r,a){var n;switch(e["Name"]){case"Textbox":n=this.createTextBoxField(e,t,"text");break;case"Password":n=this.createTextBoxField(e,t,"password");break;case"RadioButton":n=this.createRadioBoxField(e,t,"radio");break;case"CheckBox":n=this.createRadioBoxField(e,t,"checkbox",r);break;case"DropDown":n=this.createDropDownField(e,t,i,r);break;case"ListBox":n=this.createListBoxField(e,t);break;case"InitialField":case"SignatureField":n=this.createSignatureField(e,t,i,r,a);var s=!1;0===e["Rotation"]&&(s=!0),e.Value&&""!==e.Value&&(this.renderExistingAnnnot(e,i,r,s),this.isSignatureRendered=!0,a++);break;case"Button":n=this.createButtonField(e,t);break;case"ink":this.pdfViewer.formDesignerModule&&e.Value&&""!==e.Value&&!this.isSignatureRendered&&this.renderExistingAnnnot(e,i,r);break;case"SignatureText":case"SignatureImage":e.Value&&""!==e.Value&&!this.isSignatureRendered&&this.renderExistingAnnnot(e,i,r);break}return{currentField:n,count:a}},e.prototype.getFormFieldType=function(e){var t;switch(e["Name"]){case"Textbox":t="Textbox";break;case"Password":t="Password";break;case"RadioButton":t="RadioButton";break;case"CheckBox":t="CheckBox";break;case"DropDown":t="DropDown";break;case"ListBox":t="ListBox";break;case"SignatureField":t="SignatureField",e.IsInitialField&&(t="InitialField");break;case"InitialField":t="InitialField";break}return t},e.prototype.createButtonField=function(e,t){var i=document.createElement("input");return e.Value?(i.type="image",i.src=e.Value):i.type="button",i.className="e-pv-buttonItem",""!==e.Text?i.value=e.Text:i.value="",i.name=e.FieldName,i},e.prototype.createTextBoxField=function(e,t,i){var r;if(1!==e.Visible)return e.Multiline?(r=document.createElement("textarea"),r.style.resize="none"):(r=document.createElement("input"),r.type=i),e.MaxLength>0&&(r.maxLength=e.MaxLength),this.addAlignmentPropety(e,r),""!==e.Text?r.value=e.Text:r.value="",this.pdfViewer.enableAutoComplete||(r.autocomplete="off"),r.name=e.FieldName,r},e.prototype.checkIsReadonly=function(e,t){for(var i=!1,r=0;r<this.readOnlyCollection.length;r++)if(t.id===this.readOnlyCollection[r]){i=!0;break}if(this.pdfViewer.formDesignerModule||this.pdfViewer.annotationModule||!e.IsInitialField&&!e.IsSignatureField||(i=!0),e.IsReadonly||!this.pdfViewer.enableFormFields||i)t.disabled=!0,t.style.cursor="default",t.style.backgroundColor="transparent";else{var a=e.BackColor;t.style.backgroundColor="rgba("+a.R+","+a.G+","+a.B+",0.2)";var n=e.FontColor;t.style.color="rgba("+n.R+","+n.G+","+n.B+",1)"}},e.prototype.formFieldsReadOnly=function(e){var t=document.getElementsByClassName("e-pdfviewer-formFields");this.makeformFieldsReadonly(t,e);var i=document.getElementsByClassName("e-pdfviewer-signatureformfields");this.makeformFieldsReadonly(i,e)},e.prototype.makeformFieldsReadonly=function(e,t){for(var i=0;i<e.length;i++)if(e[i]){var r=e[i];t?r.disabled=!1:(r.disabled=!0,r.style.cursor="default")}},e.prototype.applyTabIndex=function(e,t,i){t.tabIndex=e.TabIndex,this.maxTabIndex=Math.max(this.maxTabIndex,t.tabIndex),-1===this.minTabIndex&&(this.minTabIndex=t.tabIndex),this.minTabIndex=Math.min(this.minTabIndex,t.tabIndex),this.maintainTabIndex[i.toString()]=this.maxTabIndex,this.maintanMinTabindex[i.toString()]=this.minTabIndex},e.prototype.checkIsRequiredField=function(e,t){if(e.IsRequired)t.required=!0,t.style.border="1px solid red";else{var i=e.BorderColor;t.style.border=e.BorderWidth,t.style.borderColor="rgba("+i.R+","+i.G+","+i.B+",1)"}if("checkbox"!==t.type&&"radio"!==t.type){var r=e.BorderStyle;this.addBorderStylePropety(r,t)}},e.prototype.applyDefaultColor=function(e){"button"===e.type||"rgba(255, 255, 255, 0.2)"!==e.style.backgroundColor&&"rgba(0, 0, 0, 0.2)"!==e.style.backgroundColor||(e.style.backgroundColor="rgba(0, 20, 200, 0.2)"),"rgba(255, 255, 255, 0.2)"===e.style.color&&(e.style.color="black")},e.prototype.addAlignmentPropety=function(e,t){var i=e.Alignment;switch(i){case 0:t.style.textAlign="left";break;case 1:t.style.textAlign="center";break;case 2:t.style.textAlign="right";break;case 3:t.style.textAlign="justify";break}},e.prototype.addBorderStylePropety=function(e,t){switch(e){case 0:t.style.borderStyle="solid";break;case 1:t.style.borderStyle="dashed";break;case 2:t.style.borderStyle="outset";break;case 3:t.style.borderStyle="inset";break;case 4:t.style.borderStyle="outset";break;case 5:t.style.borderStyle="dotted";break;case 6:t.style.borderStyle="inset";break}},e.prototype.createRadioBoxField=function(e,t,i,r){var a=document.createElement("input");return a.type=i,e.Selected&&(a.checked=!0),a.name=e.GroupName,a.value=e.Value,a},e.prototype.createDropDownField=function(e,t,i,r){var a=document.createElement("select"),n=e["TextList"];if(e.Selected&&!r){var s=document.getElementById("editableDropdown"+t+"_"+i);s&&s.remove();var o=document.createElement("input");o.id="editableDropdown"+t+"_"+i,o.setAttribute("list",this.pdfViewer.element.id+"input_"+t+"_"+i);var d=e["LineBounds"],l=e["Font"];if(o.style.position="absolute",o.style.border="0px",this.applyPosition(o,d,l,t,e["Rotation"]),o.style.backgroundColor="rgba(0, 20, 200, 0.2)",o.className="e-pdfviewer-formFields",-1===e.selectedIndex&&(o.value=e.SelectedValue),r)r.appendChild(o);else{var h=document.getElementById(this.pdfViewer.element.id+"_textLayer_"+t);h.appendChild(o)}o.addEventListener("focus",this.focusFormFields.bind(this)),o.addEventListener("blur",this.blurFormFields.bind(this)),o.addEventListener("click",this.updateFormFields.bind(this)),o.addEventListener("change",this.changeFormFields.bind(this)),o.addEventListener("keydown",this.updateFormFieldsValue.bind(this)),a=document.createElement("DATALIST")}for(var u=0;u<n.length;u++){var f=document.createElement("option");f.className="e-dropdownSelect",e.SelectedValue===n[u]||e.selectedIndex===u?f.selected=!0:f.selected=!1,f.innerHTML=n[u],a.appendChild(f)}return a.name=e.Text,a},e.prototype.createListBoxField=function(e,t){var i=document.createElement("select"),r=e["TextList"];e.MultiSelect?i.multiple=!0:(i.multiple=!1,i.size=r.length);for(var a=0;a<r.length;a++){var n=document.createElement("option");n.className="e-pdfviewer-ListBox";for(var s=0;s<e.SelectedList.length;s++)e.SelectedList[s]===a&&(n.selected=!0);n.innerHTML=r[a],i.appendChild(n)}return i.name=e.Text,i},e.prototype.createSignatureField=function(e,t,i,a,n){var s=document.createElement("input");s.type="text",s.name=e.FieldName;var o=document.getElementById("signIcon"+t+"_"+i);o&&!a&&o.remove(),this.pdfViewerBase.isInitialField=e.IsInitialField;var d=this.pdfViewerBase.isInitialField?"Initial":"Sign",l=19===this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.width?this.pdfViewerBase.isInitialField?27:19:this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.width,h=document.createElement("span"),u=document.getElementById(this.pdfViewer.element.id+"_textLayer_"+t),f=e["LineBounds"],g=(e["Font"],this.ConvertPointToPixel(f.X)),p=this.ConvertPointToPixel(f.Y),c=this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.height>f.Height/2?f.Height/2:this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.height,m=l>f.Width/2?f.Width/2:l,F=this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.fontSize>c/2?10:this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.fontSize;h.style.position="absolute",h.id="signIcon"+t+"_"+i;var w=this.pdfViewerBase.getZoomFactor(),y=this.getAngle(t),v={left:g,top:p,width:m,height:c},S=this.getBounds(v,t);return h.style.transform="rotate("+y+"deg)",h.style.left=S.left*w+"px",h.style.top=S.top*w+"px",r["c"].isDevice&&!this.pdfViewer.enableDesktopMode?(h.style.height="5px",h.style.width="10px",h.style.fontSize="3px"):(h.style.height=c+"px",h.style.width=m+"px",h.style.fontSize=F+"px",Object(r["K"])()&&(h.style.fontSize=F-1+"px")),h.style.padding="2px",h.style.textAlign="center",h.style.boxSizing="content-box",h.innerHTML=this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.text?this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.text:d,h.style.color=this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.color?this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.color:"black",h.style.backgroundColor=this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.backgroundColor?this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.backgroundColor:"orange",h.style.opacity=this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.opacity?this.pdfViewer.signatureFieldSettings.signatureIndicatorSettings.opacity:1,u.appendChild(h),this.addSignaturePath(e,n),s},e.prototype.addSignaturePath=function(e,t){this.isSignatureField=!1;var i=this.pdfViewerBase.getItemFromSessionStorage("_formfields");if(i)for(var r=JSON.parse(i),a=0;a<r.length;a++){var n=r[a];if(("ink"===n.Name||"SignatureField"===n.Name||"SignatureImage"===n.Name||"SignatureText"===n.Name)&&n.FieldName===e.ActualFieldName+"_"+t&&n.Value&&""!==n.Value){e.Value=n.Value,e.FontFamily=n.FontFamily,e.FontSize=n.FontSize,this.isSignatureField=!0,e.Bounds||(e.Bounds=n.LineBounds);break}}return this.isSignatureField},e.prototype.getBounds=function(e,t,i,r){var a,n=this.pdfViewerBase.pageSize[t];return a=i>0?this.getBoundsPosition(i,e,n,r):this.getBoundsPosition(n.rotation,e,n,r),a},e.prototype.getBoundsPosition=function(e,t,i,r){var a;if(r){switch(e){case 0:a=t;break;case 1:a={left:i.width-t.top-t.height-(t.width/2-t.height/2),top:t.left+(t.width/2-t.height/2),width:t.width,height:t.height};break;case 2:a={left:i.width-t.left-t.width,top:i.height-t.top-t.height,width:t.width,height:t.height};break;case 3:a={left:t.top-(t.width/2-t.height/2),top:i.height-t.left-t.width+(t.width/2-t.height/2),width:t.width,height:t.height};break}a||(a=t)}else{switch(e){case 90:a={left:i.width-t.top-t.height,top:t.left,width:t.height,height:t.width};break;case 180:a={left:i.width-t.left-t.width,top:i.height-t.top-t.height,width:t.width,height:t.height};break;case 270:a={left:t.top,top:i.height-t.left-t.width,width:t.height,height:t.width};break;case 0:a=t;break;case 1:a={left:i.width-t.top-t.height,top:t.left,width:t.height,height:t.width};break;case 2:a={left:i.width-t.left-t.width,top:i.height-t.top-t.height,width:t.width,height:t.height};break;case 3:a={left:t.top,top:i.height-t.left-t.width,width:t.height,height:t.width};break}a||(a=t)}return a},e.prototype.applyPosition=function(e,t,i,r,a,n){if(t){var s=this.ConvertPointToPixel(t.X),o=this.ConvertPointToPixel(t.Y),d=this.ConvertPointToPixel(t.Width),l=this.ConvertPointToPixel(t.Height),h=0,u={left:s,top:o,width:d,height:l},f=this.getBounds(u,r,a,n);null!==i&&i.Height&&(e.style.fontFamily=i.Name,i.Italic&&(e.style.fontStyle="italic"),i.Bold&&(e.style.fontWeight="Bold"),h=this.ConvertPointToPixel(i.Size)),this.pdfViewerBase.setStyleToTextDiv(e,f.left,f.top,h,f.width,f.height,!1)}},e.prototype.renderExistingAnnnot=function(e,t,i,a){if(!i){var n=void 0;n=e.Bounds&&"ink"!==e.Name?e.Bounds:e.LineBounds;var s=void 0,o=void 0,d=void 0,l=void 0;n.x||n.y||n.width||n.height?(s=n.x,o=n.y,d=n.width,l=n.height):(s=this.ConvertPointToPixel(n.X),o=this.ConvertPointToPixel(n.Y),d=this.ConvertPointToPixel(n.Width),l=this.ConvertPointToPixel(n.Height));var h=parseFloat(e["PageIndex"]),u={left:s,top:o,width:d,height:l},f=this.updateSignatureBounds(u,h,a),g=void 0,p=e.FontFamily?e.FontFamily:e.fontFamily;if(e.Value.split("base64,")[1])g={id:this.pdfViewer.element.id+"input_"+h+"_"+t,bounds:f,pageIndex:h,data:e.Value,modifiedDate:"",shapeAnnotationType:"SignatureImage",opacity:1,rotateAngle:a?this.getAngle(h):0,annotName:"SignatureField",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""}};else if(!p||e.Value&&e.Value.startsWith("M")&&e.Value.split(",")[1].split(" ")[1].startsWith("L")){var c=f,m={left:f.x,top:f.y,width:f.width,height:f.height};c=this.updateSignatureBounds(m,h,!1),g={id:this.pdfViewer.element.id+"input_"+h+"_"+t,bounds:c,pageIndex:h,data:e.Value,modifiedDate:"",shapeAnnotationType:"Path",opacity:1,rotateAngle:0,annotName:"SignatureField",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""}}}else g={id:this.pdfViewer.element.id+"input_"+h+"_"+t,bounds:f,pageIndex:h,data:e.Value,modifiedDate:"",shapeAnnotationType:"SignatureText",opacity:1,rotateAngle:a?this.getAngle(h):0,annotName:"SignatureField",comments:[],review:{state:"",stateModel:"",modifiedDate:"",author:""},fontFamily:e.FontFamily,fontSize:e.FontSize},g.fontFamily=p,g.fontSize=e.FontSize?e.FontSize:e.fontSize;if("SignatureField"!==e.Name&&"InitialField"!==e.Name||Object(r["L"])(e.id)){var F=document.getElementById(g.id);F&&F.classList.contains("e-pdfviewer-signatureformfields-signature")&&this.pdfViewer.annotation.deleteAnnotationById(g.id),this.pdfViewer.add(g)}else{var w=e.id,y=document.getElementById(w+"_content_html_element"),v=this.pdfViewer.nameTable[w];g.id=v.id+"_content";var S=this.pdfViewer.add(g);if(v.wrapper.children.push(S.wrapper),!Object(r["L"])(y)&&this.isSignatureField){var x=y.children[0].children[0];x.style.pointerEvents="none",x.className="e-pdfviewer-signatureformfields-signature",x.parentElement.style.pointerEvents="none"}else if(!Object(r["L"])(y)&&e.Value){x=y.children[0].children[0];x.style.pointerEvents="none",x.className="e-pdfviewer-signatureformfields-signature",x.parentElement.style.pointerEvents="none"}}e.Bounds=g.bounds,this.pdfViewer.formDesignerModule&&this.updateSignatureDataInSession(g,g.id);var b=document.getElementById(this.pdfViewer.element.id+"_annotationCanvas_"+h);this.pdfViewer.renderDrawing(b,h)}},e.prototype.updateSignatureBounds=function(e,t,i){var r=this.pdfViewerBase.pageSize[t];return r?i?1===r.rotation?{x:r.width-e.top-e.height-(e.width/2-e.height/2),y:e.left+(e.width/2-e.height/2),width:e.width,height:e.height}:2===r.rotation?{x:r.width-e.left-e.width,y:r.height-e.top-e.height,width:e.width,height:e.height}:3===r.rotation?{x:e.top-(e.width/2-e.height/2),y:r.height-e.left-e.width+(e.width/2-e.height/2),width:e.width,height:e.height}:{x:e.left,y:e.top,width:e.width,height:e.height}:1===r.rotation?{x:r.width-e.top-e.height,y:e.left,width:e.height,height:e.width}:2===r.rotation?{x:r.width-e.left-e.width,y:r.height-e.top-e.height,width:e.width,height:e.height}:3===r.rotation?{x:e.top,y:r.height-e.left-e.width,width:e.height,height:e.width}:{x:e.left,y:e.top,width:e.width,height:e.height}:{x:e.left,y:e.top,width:e.width,height:e.height}},e.prototype.resetFormFields=function(){for(var e=this.pdfViewer.formFieldCollections,t=0;t<e.length;t++){var i=e[t];if(this.currentTarget=document.getElementById(i.id),"Textbox"===i.type)this.currentTarget.value=i.value;else if("RadioButton"===i.type)this.currentTarget.checked=i.value,i.value&&this.updateDataInSession(this.currentTarget);else if("DropDown"===i.type)this.currentTarget.value=i.value;else if("CheckBox"===i.type)this.currentTarget.checked=i.value;else if("SignatureField"===i.type){var r=this.pdfViewer.nameTable[i.id];r&&(this.currentTarget&&"e-pdfviewer-signatureformfields-signature"===this.currentTarget.className&&(this.currentTarget.className="e-pdfviewer-signatureformfields",this.currentTarget.style.pointerEvents="",this.updateDataInSession(this.currentTarget,"")),this.pdfViewer.remove(r),this.pdfViewer.renderDrawing())}"RadioButton"!==i.type&&"SignatureField"!==i.type&&this.updateDataInSession(this.currentTarget)}},e.prototype.clearFormFieldStorage=function(){var e=Math.round(JSON.stringify(window.sessionStorage).length/1024),t=4500;if(e>t){for(var i=window.sessionStorage.length,r=[],a=0;a<i;a++)window.sessionStorage.key(a)&&window.sessionStorage.key(a).split("_")[3]&&"annotations"===window.sessionStorage.key(a).split("_")[3]&&(this.pdfViewerBase.formFieldStorage[window.sessionStorage.key(a)]=window.sessionStorage.getItem(window.sessionStorage.key(a)),r.push(window.sessionStorage.key(a)));if(r)for(a=0;a<r.length;a++)window.sessionStorage.removeItem(r[a])}},e.prototype.clearFormFields=function(e){var t=this.pdfViewerBase.getItemFromSessionStorage("_formfields");if(t){var i=void 0;i=e?[e]:JSON.parse(t);for(var r=!0,a=0;a<i.length;a++){var n=i[a];if(e&&(n.uniqueID=e.id,n.Name=e.type),this.currentTarget=document.getElementById(n.uniqueID),"Textbox"===n.Name)this.currentTarget.value="";else if("RadioButton"===n.Name)r&&(this.currentTarget.checked=!0,this.updateDataInSession(this.currentTarget),r=!1);else if("DropDown"===n.Name)this.currentTarget.value=n.TextList[0];else if("CheckBox"===n.Name)this.currentTarget.checked=!1;else if("SignatureField"===n.Name){var s=this.pdfViewer.nameTable[n.uniqueID];s&&(this.currentTarget&&"e-pdfviewer-signatureformfields-signature"===this.currentTarget.className&&(this.currentTarget.className="e-pdfviewer-signatureformfields",this.currentTarget.style.pointerEvents="",this.currentTarget.parentElement.style.pointerEvents="",this.updateDataInSession(this.currentTarget,""),e&&(e.value="",e.signatureType=[e.signatureType],e.signatureType[0]="")),this.pdfViewer.remove(s),this.pdfViewer.renderDrawing())}"SignatureField"!==n.Name&&"ink"!==n.Name&&"RadioButton"!==n.Name&&this.updateDataInSession(this.currentTarget)}}},e.prototype.ConvertPointToPixel=function(e){return e*(96/72)},e.prototype.destroy=function(){this.currentTarget=null,this.readOnlyCollection=[],this.pdfViewerBase&&this.pdfViewerBase.signatureModule&&this.pdfViewerBase.signatureModule.destroy()},e.prototype.getModuleName=function(){return"FormFields"},e.prototype.getTextWidth=function(e,t,i){var r,a=document.createElement("canvas"),n=a.getContext("2d");return t&&(r=t+"px "+i),n.font=r||getComputedStyle(document.body).font,n.measureText(e).width},e.prototype.getFontSize=function(e){return e%2===0?e:--e},e}()}}]);
//# sourceMappingURL=chunk-vendors~50eb333b.5fbe390d.js.map